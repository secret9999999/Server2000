From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: ChristopheG <61288881+chrisgdt@users.noreply.github.com>
Date: Sat, 13 Aug 2022 13:57:03 +0200
Subject: [PATCH] Add LocalCoordinates API


diff --git a/src/main/java/org/bukkit/Bukkit.java b/src/main/java/org/bukkit/Bukkit.java
index 840aaf9e8fc828b5a7ea02252038c6524680f2e0..41876a2cf3b02eaa33d838ed149e410b1b682951 100644
--- a/src/main/java/org/bukkit/Bukkit.java
+++ b/src/main/java/org/bukkit/Bukkit.java
@@ -903,6 +903,27 @@ public final class Bukkit {
         return server.createExplorerMap(world, location, structureType, radius, findUnexplored);
     }
 
+    // Paper start
+    /**
+     * Computes local coordinates according to the given location
+     * and coordinates.
+     * <br>
+     * Local coordinates are used in vanilla with <code>^x ^y ^z</code> and
+     * depends on the rotation of the target. The head (yaw and pitch) gives
+     * the new orthonormal field that coordinates follow.
+     *
+     * @param location the location with direction to define local coordinates,
+     *                 e.g. given by entity.getLocation()
+     * @param x the "left" component
+     * @param y the "up" component
+     * @param z the "forwards" component
+     * @return a newly created location with local coordinates applied according to the given location
+     */
+    @NotNull
+    public static Location applyLocalCoordinates(@NotNull Location location, double x, double y, double z) {
+        return server.applyLocalCoordinates(location, x, y, z);
+    }
+    // Paper end
     /**
      * Reloads the server, refreshing settings and plugin information.
      */
diff --git a/src/main/java/org/bukkit/Server.java b/src/main/java/org/bukkit/Server.java
index da5cab4246bd253fcc4e4d9574bdae1867ebb5ab..889c682c8935eb3cfc7791e406fabfd082fccb87 100644
--- a/src/main/java/org/bukkit/Server.java
+++ b/src/main/java/org/bukkit/Server.java
@@ -754,6 +754,25 @@ public interface Server extends PluginMessageRecipient, net.kyori.adventure.audi
     @NotNull
     public ItemStack createExplorerMap(@NotNull World world, @NotNull Location location, @NotNull StructureType structureType, int radius, boolean findUnexplored);
 
+    // Paper start
+    /**
+     * Computes local coordinates according to the given location
+     * and coordinates.
+     * <br>
+     * Local coordinates are used in vanilla with <code>^x ^y ^z</code> and
+     * depends on the rotation of the target. The head (yaw and pitch) gives
+     * the new orthonormal field that coordinates follow.
+     *
+     * @param location the location with direction to define local coordinates,
+     *                 e.g. given by entity.getLocation()
+     * @param x the "left" component
+     * @param y the "up" component
+     * @param z the "forwards" component
+     * @return a newly created location with local coordinates applied according to the given location
+     */
+    @NotNull
+    public Location applyLocalCoordinates(@NotNull Location location, double x, double y, double z);
+    // Paper end
     /**
      * Reloads the server, refreshing settings and plugin information.
      */
