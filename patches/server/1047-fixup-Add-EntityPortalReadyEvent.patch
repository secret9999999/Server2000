From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Jake Potrebic <jake.m.potrebic@gmail.com>
Date: Thu, 16 May 2024 11:35:16 -0700
Subject: [PATCH] fixup! Add EntityPortalReadyEvent


diff --git a/src/main/java/net/minecraft/world/entity/Entity.java b/src/main/java/net/minecraft/world/entity/Entity.java
index 25ea45a528612d1a2a2d77293b3802f473a52f38..0e79da751b39eb87cbe6c04bf3558f5255ed3c1d 100644
--- a/src/main/java/net/minecraft/world/entity/Entity.java
+++ b/src/main/java/net/minecraft/world/entity/Entity.java
@@ -3230,10 +3230,10 @@ public abstract class Entity implements SyncedDataHolder, Nameable, EntityAccess
                     this.portalTime = i;
                     // Paper start - Add EntityPortalReadyEvent
                     io.papermc.paper.event.entity.EntityPortalReadyEvent event = new io.papermc.paper.event.entity.EntityPortalReadyEvent(this.getBukkitEntity(), worldserver1 == null ? null : worldserver1.getWorld(), org.bukkit.PortalType.NETHER);
-                    if (!event.callEvent()) {
+                    if (!event.callEvent() || event.getTargetWorld() == null) {
                         this.portalTime = 0;
                     } else {
-                        worldserver1 = event.getTargetWorld() == null ? null : ((CraftWorld) event.getTargetWorld()).getHandle();
+                        worldserver1 = ((CraftWorld) event.getTargetWorld()).getHandle();
                     // Paper end - Add EntityPortalReadyEvent
                     this.setPortalCooldown();
                     // CraftBukkit start
